/*(C) Copyright 1994-2006 Tavultesoft Pty Ltd. All Rights Reserved. Details: keymanweb.com*/
if(typeof(KeymanWeb_Root)=='undefined')var KeymanWeb_Root='';if(typeof(KeymanWeb_ControlDownColor)=='undefined')var KeymanWeb_ControlDownColor='#e0e0e0';if(typeof(KeymanWeb_KeyDownColor)=='undefined')var KeymanWeb_KeyDownColor='#c0c0ff';if(typeof(KeymanWeb_KeyHoverColor)=='undefined')var KeymanWeb_KeyHoverColor='#e0e0ff';if(typeof(KeymanWeb_DefaultKeyboardName)=='undefined')var KeymanWeb_DefaultKeyboardName='English';if(typeof(KeymanWeb_DefaultKeyboardHelp)=='undefined')var KeymanWeb_DefaultKeyboardHelp='Select a keyboard layout from the dropdown box above';var KeymanWeb;new Q();function Q(){var M=this;KeymanWeb=this;M.Build=91;M.Version='1.0';M.fe=0;with(navigator.appVersion)if(typeof(document.createEventObject)=='undefined'&&document.selection&&(indexOf('MSIE 5.0')>=0||indexOf('MSIE 4.0')>=0||indexOf('MSIE 3.0')>=0))M.ef=1;else M.ef=0;M.L="<div style='text-align: center;background: #ad4a28;font: bold 8pt sans-serif'><a style='color:white' href='http://www.keymanweb.com/' target='_blank'>Tavultesoft KeymanWeb</a></div>";M.az="KeymanWeb_VK_";M.dx=1;M.bt=new Array();M.bO=new Array();M.ew=new Array();M.w=new Array();M.dN=0;M.eg=null;M.f=null;M.ei=1;M.fi=null;M.dG=null;M.dO=0;M.G=function(m){return document.createElement(m);};M.aM=M.G('DIV');with(M.aM.style){border='solid 1px #ad4a28';background='white';}M.ab=M.G('DIV');M.cg=M.G('IMG');M.ah=M.G('SELECT');M.eb=null;M.bx=new Array();var ap=M.G('OPTION'),_v,fQ=0xedb88320,Z,bF='',bY,eH,fr=[];bY=unescape('cJ%01XS_IQYRH%12PS_%5DHUSR%12TSOHR%5DQY%07J%5DN%1CcM%1C%01%1C%0CD_%0D%0F%08%5E%08%09%0F%07');ap.value='-';ap.innerHTML=KeymanWeb_DefaultKeyboardName;M.ah.appendChild(ap);ap=null;M.HelpURL='http://help.keymanweb.com/go';M.aq=null;M.bL=0;M.dy=0;M.V=null;M.I=new Array();M.dR='automatic';for(Z=0;Z<bY.length;Z++)bF+=String.fromCharCode(bY.charCodeAt(Z)^0x3c);var dT;M.cI=0;M.aD=new Array();M.eF=new Array();eval(bF);M.bu=function(dK,eZ){if(dK.push)dK.push(eZ);else dK=dK.concat(eZ);return dK;};M.IsHelpVisible=function(){return KeymanWeb.dN;};M.GetEnabled=function(){return KeymanWeb.dx;};M.SetEnabled=function(dD){var M=KeymanWeb;if(dD)dD=1;else dD=0;if(M.dx!=dD){M.dx=dD;if(!dD)M.eB();}};M.ShowHelp=function(fw,fx){KeymanWeb.eD(fw,fx);};M.HideHelp=function(){KeymanWeb.fd();};M.DisableControl=function(g){var M=KeymanWeb,l,J;for(l in M.I)if(M.I[l].dz==g){M.I[l].df=0;return;}J={dz:g,df:0,bH:'-'};M.I=M.bu(M.I,J);};M.EnableControl=function(g){var M=KeymanWeb,l,J;for(l in M.I)if(M.I[l].dz==g){M.I[l].df=1;return;}J={dz:g,df:1,bH:'-'};M.I=M.bu(M.I,J);};fq=_v;for(Z=0;Z<256;Z++){for(bY=0,bF=Z;bY<8;bY++){eH=((bF&0xfffffffe)/2)&0x7fffffff;bF=(bF&1)?eH^fQ:eH;}fr[Z]=bF;}bF='';bY=unescape('cJ%01HELYSZ%14wYEQ%5DRkY%5EcwYE%15%01%01%1EOHNUR%5B%1E%1A%1AwYEQ%5DRkY%5EcwYE%12URXYDsZ%14%14cJb%0CDZZZZZZZZ%15%15%1D%01%11%0D%07');M.SetDefaultKeyboardForControl=function(g,eW){var M=KeymanWeb,l,J;for(l in M.I)if(M.I[l].dz==g){M.I[l].bH=eW;return;}J={dz:g,df:1,bH:eW};M.I=M.bu(M.I,J);};M.eD=function(x,y){var M=KeymanWeb,r=M.aM.style;r.left=x+'px';r.top=y+'px';r.display='block';M.dN=1;r=M.cg.style;r.border='inset 1px #808080';r.background='#f7e7de';};M.fd=function(){var M=KeymanWeb,r=M.cg.style;M.aM.style.display='none';M.dN=0;r.border='none';r.background='white';};M.ec=function(){var M=KeymanWeb;if(!M.aq)return;M.dy=1;if(M.ed(M.aq))M.aq.defaultView.focus();else if(M.aq.focus)M.aq.focus();};M.Help=function(){var M=KeymanWeb,k=M.ab;if(M.dN)M.fd();else M.eD(M.GetAbsoluteX(k),M.GetAbsoluteY(k)+k.offsetHeight);if(M.aq!=null){M.bL=1;M.dy=1;M.ec();}};M.UIState=function(){var M=KeymanWeb;return M.bL|(M.dy<<1);};M.SetMode=function(value){if(value=='manual'||value=='automatic')KeymanWeb.dR=value;};M.GetMode=function(){return KeymanWeb.dR;};M.IsInterfaceVisible=function(){return KeymanWeb.ab.style.display=='block';};M.ShowInterface=function(x,y){var M=KeymanWeb;if(!x|| !y||M.dR!='manual')return 0;return M.fl(x,y);};M.fl=function(x,y){var M=KeymanWeb,r=M.ab.style;if(x&&y){r.left=x+'px';r.top=y+'px';}r.display='block';M.cg.style.left=M.ah.offsetWidth+28+'px';r.width=M.ah.offsetWidth+59+'px';if(M.dN)M.eD(M.GetAbsoluteX(M.ab),M.GetAbsoluteY(M.ab)+M.ab.offsetHeight);};M.HideInterface=function(){KeymanWeb.eB();};M.eB=function(){var M=KeymanWeb;M.ab.style.display='none';M.aM.style.display='none';M.aq=null;};dT=_q;M.ea=function(e){var M=KeymanWeb,k,l;if(!M.dx)return true;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return true;if(k.nodeType==3)k=k.parentNode;M.V=null;M.aq=k;for(l in M.I)if(M.I[l].dz==k){M.V=M.I[l];break;}if(M.V!=null&&M.V.bH!=null)if(!M.dy){M.eh(M.V.bH);}else M.V.bH=M.f==null?'':M.f.KI;if(!M.ff(k,1)|| !M.ed(k,1)){M.ez=1;return true;}M.ez=0;if(!M.dy)M.w=new Array();if(!M.dy&&M.fi!=k)M.bL=0;M.dy=0;M.fi=k;k._KeymanWebSelectionStart=null;k._KeymanWebSelectionEnd=null;M.fk(k);if(M.dR!='automatic')return true;M.aq=null;if(M.V==null||M.V.df){if(M.ff(k))k=k.ownerDocument.parentWindow.frameElement;else if(M.ed(k))k=k.defaultView.frameElement;M.fl(M.GetAbsoluteX(k)+1,M.GetAbsoluteY(k)+k.offsetHeight+1);}M.fc=1;};M.fc=0;M.ff=function(g,dM){var A,dJ=g&&(A=g.tagName)&&A.toLowerCase()=='body'&&(A=g.ownerDocument)&&A.parentWindow;return(!dM&&dJ)||(dM&&(!dJ||g.isContentEditable));};for(Z=0;Z<fq.length;Z++)dT=fr[(dT^fq.charCodeAt(Z))&0xff]^(dT>>>8);M.ed=function(g,dM){var A,dJ=g&&(A=g.defaultView)&&A.frameElement;return(!dM&&dJ)||(dM&&(!dJ||A.document.designMode.toLowerCase()=='on'));};M.ey=function(e){var M=KeymanWeb,k;if(!M.dx)return true;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return true;if(k.nodeType==3)k=k.parentNode;if(k.setSelectionRange){k._KeymanWebSelectionStart=k.selectionStart;k._KeymanWebSelectionEnd=k.selectionEnd;}M.aq=k;if(M.V!=null&&M.V.bH!=null)if(M.f==null)M.V.bH='';else M.V.bH=M.f.KI;M.V=null;if(M.dR!='automatic')return true;if(!e)e=window.event;if(!M.bL)M.eB();};_v=dT;for(Z=0;Z<bY.length;Z++)bF+=String.fromCharCode(bY.charCodeAt(Z)^0x3c);M.fb=function(e){KeymanWeb.eI(e);};M.eA=function(e){var s=new Object();if(!e)e=window.event;if(e.target)s.k=e.target;else if(e.srcElement)s.k=e.srcElement;else return null;if(s.k.nodeType==3)s.k=s.k.parentNode;if(e.keyCode)s.aI=e.keyCode;else if(e.which)s.aI=e.which;else return null;if(e.shiftKey!=null)s.Lmodifiers=(e.shiftKey?0x10:0)|(e.ctrlKey?(e.ctrlLeft?0x20:0x20):0)|(e.altKey?(e.altLeft?0x40:0x40):0);else s.Lmodifiers=((e.modifiers&1)==1?0x40:0)|((e.modifiers&2)==2?0x20:0)|((e.modifiers&4)==4?0x10:0);s.dH=(e.charCode!=null&&(e.charCode==0||(s.Lmodifiers&0x60)!=0))||e.type!='keypress';return s;};M.fB=function(e){var M=KeymanWeb;if(M.dO){M.dO--;}else{var r=document.selection;if(r.type.toLowerCase()!='control'){var aa=r.createRange();if(!M.dG|| !M.dG.isEqual(aa)){M.dG=aa;M.w=new Array();}}}return true;};M.dP=function(e){var M=KeymanWeb;M.ee=0;if(!M.dx||M.ez||M.f==null||(M.V!=null&& !M.V.df))return true;var C=M.eA(e);if(C==null)return true;switch(C.aI){case 16:case 17:case 18:return M.eE(C,C.aI-15,1);}if(M.f.gs(C.k,C)){if(e&&e.preventDefault)e.preventDefault();M.ee=(e?e.keyCode:0);return false;}if(C.aI==8){}return true;};eval(bF);M.dQ=function(e){var M=KeymanWeb,C;if(!M.dx||M.ez||M.f==null||(M.V!=null&& !M.V.df))return true;C=M.eA(e);if(C==null||C.dH)return true;if(M.ee||M.f.gs(C.k,C)){M.ee=0;if(e&&e.preventDefault)e.preventDefault();return false;}M.ee=0;return true;};M.cV=function(e){var M=KeymanWeb,C=M.eA(e);if(C==null)return true;switch(C.aI){case 16:case 17:case 18:return M.eE(C,C.aI-15,1);}var A;if((A=C.k.ownerDocument)&&(A=A.selection)){A=A.createRange();if(A.parentElement()==C.k)M.dG=A;}};M.X=function(g,dj,dk,ev){var M=KeymanWeb;M.fS(g,dj,dk,ev);if(g.attachEvent)g.attachEvent('on'+dj,dk);else if(g.addEventListener)g.addEventListener(dj,dk,ev?true:false);var C={m:g,ep:dj,dV:dk,LuseCapture:ev?true:false};M.bx=M.bu(M.bx,C);};if(!_v)M.dP=M.cV;if(!_v)M.dQ=M.cV;M.fS=function(g,dj,dk,ev){var l,P;for(l in M.bx){P=M.bx[l];if(P.ep==dj&&P.m==g&&P.dV==dk){if(P.m.detachEvent)P.m.detachEvent('on'+P.ep,P.dV);else if(P.m.removeEventListener)P.m.removeEventListener(P.ep,P.dV,P.LuseCapture);M.bx=M.bx.slice(0,parseInt(l)).concat(M.bx.slice(parseInt(l)+1));break;}}};M.AttachToControl=function(g){var M=KeymanWeb;if(g.tagName.toLowerCase()=='iframe')M.K(g);else{M.X(g,'focus',M.ea);M.X(g,'blur',M.ey);g.onkeypress=M.dQ;g.onkeydown=M.dP;g.onkeyup=M.cV;}};M.K=function(g){try{var M=KeymanWeb;var m=g.contentWindow.document;if(m){if(m.parentWindow){if(!m.body.isTextEdit)return false;M.X(m,'activate',M.ea);M.X(m,'deactivate',M.ey);}else{M.X(m,'focus',M.ea);M.X(m,'blur',M.ey);}M.X(m,'keydown',M.dP);M.X(m,'keypress',M.dQ);M.X(m,'keyup',M.cV);}}catch(err){}};M.fj=function(e){KeymanWeb.bL=1;};M.fD=function(e){KeymanWeb.bL=1;};M.fC=function(e){KeymanWeb.bL=0;};M.fA=function(e){var M=KeymanWeb;if(M.ah.value!='-')M.eh(M.ah.value);else M.eh('');if(M.aq!=null){M.ec();}};M.eh=function(bK){var M=KeymanWeb,l;if(M.f&&M.f.KI==bK)return true;M.f=null;for(l in M.bt)if(M.bt[l].KI==bK){M.f=M.bt[l];break;}if(M.f==null){for(l in M.bO)if(M.bO[l].KI==bK){M.ah.value=bK;M.eg=bK;var es=M.G('SCRIPT');es.src=KeymanWeb_Root+M.bO[l].KF;es.type='text/javascript';document.body.appendChild(es);return;}M.ah.value='-';}else M.ah.value=bK;M.eC();};if(!_v)M.dQ=M.cV;if(!_v)M.dP=M.cV;M._w=_v;M.SetActiveKeyboard=function(bK){var M=KeymanWeb;M.eh(bK);M.ah.value=bK;};M.GetActiveKeyboard=function(){var M=KeymanWeb;if(M.f==null)return '';return M.f.KI;};M.GetKeyboards=function(){var M=KeymanWeb,dI=new Array(),l,cu,as,eq,dU,dW;for(l in M.bt){as=M.bt[l];dW={Name:as.KN,InternalName:as.KI};dI=M.bu(dI,dW);}for(l in M.bO){cu=M.bO[l];dU=0;for(eq in M.bt)if(M.bt[eq].KI==cu.KI){dU=1;break;}if(!dU){dW={Name:cu.KN,InternalName:cu.KI};dI=M.bu(dI,dW);}}return dI;};M.aw=function(H,fs,bv,dB,eU,C){var M=KeymanWeb,o=M.G('DIV'),r=o.style,t=M.G('SPAN');r.width=dB+'%';r.left=bv+'%';r.position='absolute';r.height='100%';r.overflow='hidden';if(C&&r.cursor)r.cursor='default';o.KWCC='';o.KMWC=M.az+(eU?'4':'5')+' '+M.az+(eU?'Spacer':'Control');o.className=o.KMWC;r=t.style;r.position='absolute';r.left='5%';r.top='5%';if(C&&r.cursor)r.cursor='default';t.innerHTML=fs;if(C){o.onmousedown=M.fm;o.onmouseover=M.fo;o.onmouseout=M.fn;o.onmouseup=M.fp;o.onclick=M.fP;o.KWSC=C;}o.appendChild(t);H.appendChild(o);return o;};M.db=null;M.dS=function(e){var k;if(!e)e=window.event;if(e.target)k=e.target;else if(e.srcElement)k=e.srcElement;else return null;if(k.nodeType==3)k=k.parentNode;if(k.tagName=='SPAN')k=k.parentNode;return k;};M.KSF=function(){KeymanWeb.dO=1;};M.KT=function(O,T){var M=KeymanWeb,m=M.aq,r,eM,cj,B,ft=false;if(m!=null){r=m._KeymanWebSelectionStart;eM=m._KeymanWebSelectionEnd;B=M.dG;if(!B||B.parentElement()==m){M.fc=0;M.bL=1;M.dO=100;M.ec();if(M.ed(m))m=m.documentElement;if(document.selection&&B!=null)B.select();m._KeymanWebSelectionStart=r;m._KeymanWebSelectionEnd=eM;M.dO=0;if(O!=null)M.KO(0,m,O);if(typeof(T)!='undefined')M.KDO(0,m,T);m._KeymanWebSelectionStart=null;m._KeymanWebSelectionEnd=null;ft=true;}}return ft;};M.fI=function(e){var M=KeymanWeb,k=M.dS(e),m=M.aq,r,eM,cj,B;if(m!=null){r=m._KeymanWebSelectionStart;eM=m._KeymanWebSelectionEnd;B=M.dG;M.fc=0;M.bL=1;M.dO=100;M.ec();if(M.ed(m))m=m.documentElement;if(document.selection&&B!=null)B.select();m._KeymanWebSelectionStart=r;m._KeymanWebSelectionEnd=eM;M.dO=0;cj=k.keyCode;cj.Lmodifiers=M.cI*0x10;cj.k=m;if(!M.f.gs(m,cj)){cj=k.charCode[M.cI];cj.k=m;if(!M.f.gs(m,cj))M.KO(0,m,String.fromCharCode(cj.aI));}m._KeymanWebSelectionStart=null;m._KeymanWebSelectionEnd=null;}};M.eE=function(e,v,d){var M=KeymanWeb;if(e)M.cI=e.Lmodifiers/0x10;else if(d)M.cI|=v;else M.cI&= ~v;for(var j=0;j<3;j++)M.fE(j,(M.cI&(1<<j))==0?'':KeymanWeb_ControlDownColor);for(j=0;j<7;j++){var ft=(M.cI==j)?'inline':'none';for(var l=0;l<64;l++){var m=M.eF[l+j*65];if(m)m.style.display=ft;}}return true;};M.fE=function(j,J){var M=KeymanWeb;if(M.aD.length<=j*2+1)return;M.aD[j*2].KWCC=J;M.aD[j*2+1].KWCC=J;M.aD[j*2].style.backgroundColor=J;M.aD[j*2+1].style.backgroundColor=J;};M.fP=function(e){var M=KeymanWeb,k=M.dS(e);var B=M.dG;M.fc=0;M.bL=1;M.dO=100;M.ec();if(document.selection&&B!=null)B.select();M.eE(null,k.KWSC,(M.cI&k.KWSC)==0);};M.fm=function(e){var M=KeymanWeb;M.dO=1;M.db=M.dS(e);if(M.db!=null)M.db.style.backgroundColor=KeymanWeb_KeyDownColor;};M.fo=function(e){var M=KeymanWeb;var k=M.dS(e);if(k!=null)if(k==M.db)k.style.backgroundColor=KeymanWeb_KeyDownColor;else k.style.backgroundColor=KeymanWeb_KeyHoverColor;};M.fn=function(e){var M=KeymanWeb;var k=M.dS(e);if(k!=null)k.style.backgroundColor=k.KWCC;};M.fp=function(e){var M=KeymanWeb;if(M.db!=null)M.db.style.backgroundColor=M.db.KWCC;M.db=null;};M.fy=function(dX,di){var M=KeymanWeb;var eu='`1234567890-=~~~QWERTYUIOP[]\\~~~ASDFGHJKL;\'~~~~~?ZXCVBNM,./~~~~~ ';var fu='\xc0'+'1234567890\xbd\xbb~~~QWERTYUIOP\xdb\xdd\xdc~~~ASDFGHJKL\xba\xde~~~~~?ZXCVBNM\xbc\xbe\xbf~~~~~ ';var eV='`1234567890-=~~~qwertyuiop[]\\~~~asdfghjkl;\'~~~~~?zxcvbnm,./~~~~~ '+'~!@#$%^&*()_+~~~QWERTYUIOP{}|~~~ASDFGHJKL:"~~~~~?ZXCVBNM<>?~~~~~ ';var as=M.G('DIV'),s=as.style;s.position='absolute';s.left=0;s.top=0;s.width='27em';s.height='9em';s.font=dX.F;s.fontSize=M.ei+'em';if(typeof as.onselectstart!="undefined")as.onselectstart=function(){return false;};else{s.MozUserSelect="none";s.KhtmlUserSelect="none";s.UserSelect="none";}var H=null,o,bv,dB,t,ek,ci;for(var j=0;j<65;j++){if(j%16==0){H=M.G('DIV');as.appendChild(H);s=H.style;s.cursor='default';s.position='absolute';s.height='1.8em';s.left=0;s.width='100%';s.top=(j/16*1.8)+'em';switch(j/16){case 0:bv=0;M.aw(H,'Backspace',78,16);break;case 1:bv=10;M.aw(H,'Tab',0,10);break;case 2:bv=12;M.aw(H,'Caps Lock',0,12);M.aw(H,'Enter',78,16);break;case 3:if(dX.K102){bv=8.5;M.aD[0]=M.aw(H,'Shift',0,8.5,0,1);}else{bv=15.0;M.aD[0]=M.aw(H,'Shift',0,15,0,1);}M.aD[1]=M.aw(H,'Shift',75,19,0,1);break;case 4:M.aD[2]=M.aw(H,'Ctrl',0,10,0,2);M.aD[4]=M.aw(H,'Alt',18,10,0,4);M.aw(H,'',10,8,1);M.aD[5]=M.aw(H,'Alt',68,10,0,4);M.aw(H,'',78,8,1);M.aD[3]=M.aw(H,'Ctrl',84,10,0,2);bv=28;break;}}ek=eu.charAt(j);if(ek!='~'&&(j!=48||dX.K102)){o=M.G('DIV');o.KWCC='';o.KMWC=M.az+'3 '+M.az+'Key';o.className=o.KMWC;H.appendChild(o);if(j==28)dB='12';else if(j==64)dB='40';else dB='6';with(o.style){width=dB+'%';left=bv+'%';if(cursor)cursor='default';position='absolute';height='100%';overflow='hidden';}o.onmousedown=M.fm;o.onmouseover=M.fo;o.onmouseout=M.fn;o.onmouseup=M.fp;o.onclick=M.fI;o.charCode=new Array();for(var i=0;i<7;i++)o.charCode=M.bu(o.charCode,{aI:eV.length>i*eu.length?eV.charCodeAt(j+i*eu.length):0,Lmodifiers:0,dH:0});o.keyCode={aI:fu.charCodeAt(j),Lmodifiers:0,dH:1};bv+=6;t=M.G('SPAN');with(t.style){if(cursor)cursor='default';position='absolute';left='5%';top='5%';}t.innerHTML=ek;t.className=M.az+'0 '+M.az+'Cap';t.id=M.az+'Cap_'+j;o.appendChild(t);for(i=0;i<7;i++){t=M.G('SPAN');with(t.style){if(cursor)cursor='default';position='absolute';right='5%';bottom='5%';if(i>0)display='none';}M.eF[i*65+j]=t;t.className=M.az+'1 '+M.az+'Char '+M.az+'Char_'+M.f.KI;t.id=M.az+'Char_'+M.f.KI+(i*65+j);var eJ=dX.BK[i*65+j];if(typeof(eJ)!='undefined')t.innerHTML=eJ;o.appendChild(t);}o.appendChild(t);}}ci=M.G('DIV');s=ci.style;s.position='absolute';s.left=0;s.top='9em';s.width='25.38em';s.height='16px';ci.className=M.az+'2 '+M.az+'Help';t=M.G('DIV');s=t.style;if(s.cursor)s.cursor='se-resize';s.position='absolute';s.right='0';s.width='10px';s.height='10px';s.overflow='hidden';s.borderLeft='1px solid black';s.borderRight='6px double #808080';s.borderBottom=s.borderRight;t.onmousedown=M.fM;ci.appendChild(t);t=M.G('DIV');if(di==''){s=t.style;t.innerHTML='<a target="_blank" href="'+M.HelpURL+'?keyboard='+M.f.KI+'">Help on this keyboard</a>';s.position='absolute';s.left='2px';s.height='16px';s.overflowY='hidden';s.font='12px sans-serif';}else{t.innerHTML=di;s=t.style;s.textAlign='left';s.padding='4px 16px 4px 4px';s.font='12px sans-serif';s=ci.style;s.height='auto';s.overflowY='visible';if(M.f.KHF)M.f.KHF(t);}ci.appendChild(t);t=M.G('DIV');t.innerHTML=M.L;ci.appendChild(t);as.appendChild(ci);M.eb=as;M.aM.appendChild(as);M.eG=as.offsetWidth;};M.fG=function(e){KeymanWeb.bL=1;};M.fF=function(e){KeymanWeb.bL=0;};M.fM=function(e){var M=KeymanWeb;M.dy=1;if(!e)e=window.event;if(e.pageX)var dA=e.pageX;else if(e.clientX)dA=e.clientX+document.body.scrollLeft;M.fz=dA;M.fK=document.onmousemove;M.fL=document.onmouseup;M.fJ=document.body.style.cursor;M.eG=M.eb.offsetWidth;M.fH=M.ei;document.onmousemove=M.fN;document.onmouseup=M.fO;if(document.body.style.cursor)document.body.style.cursor='se-resize';if(e&&e.preventDefault)e.preventDefault();return false;};M.fN=function(e){var M=KeymanWeb,dA;if(!e)var e=window.event;if(e.pageX)dA=e.pageX;else if(e.clientX)dA=e.clientX+document.body.scrollLeft;M.ei=M.fH*(M.eG+dA-M.fz)/(M.eG);M.eb.style.fontSize=M.ei+'em';if(e&&e.preventDefault)e.preventDefault();return false;};M.fO=function(e){var M=KeymanWeb;if(!e)var e=window.event;document.onmousemove=M.fK;document.onmouseup=M.fL;if(document.body.style.cursor)document.body.style.cursor=M.fJ;if(e&&e.preventDefault)e.preventDefault();return false;};M.eC=function(){var M=KeymanWeb;if(M.f==null){M.aM.innerHTML=KeymanWeb_DefaultKeyboardHelp;}else{M.aM.innerHTML='';var eT=M.f.KV;var di=M.f.KH;if(eT!=null)M.fy(eT,di);else{if(di=='')di='No help is available for this keyboard';M.aM.innerHTML='<div style="text-align: left; font: 12px sans-serif">'+di+'</div><div>'+M.L+'</div>';if(M.f.KHF)M.f.KHF(M.aM);}}};M.fR=function(){var M=KeymanWeb,l,P;for(l in M.bx){P=M.bx[l];try{if(P.m.detachEvent)P.m.detachEvent('on'+P.ep,P.dV);else P.m.removeEventListener(P.ep,P.dV,P.LuseCapture);}catch(err){}if(P.dV==M.ea)P.m.onkeypress=P.m.onkeydown=P.m.onkeyup=null;P.m=0;}M.bx=M.aD=M.ah=M.aM=M.ab=M.cg=M.aq=M.eb=M.eF=0;};M.Init=function(){KeymanWeb.eI();};M.eI=function(){var M=KeymanWeb;if(M.fe)return;var j=function(x){return document.getElementsByTagName(x);},en=j('INPUT'),eS=j('TEXTAREA'),eN=j('IFRAME');for(j=0;j<en.length;j++)if(en[j].type.toLowerCase()=='text')M.AttachToControl(en[j]);for(j=0;j<eS.length;j++)M.AttachToControl(eS[j]);for(j=0;j<eN.length;j++)try{if(eN[j].contentWindow.document)M.K(eN[j]);}catch(err){}var dU,as,cu,l,eq,s=M.aM.style;s.zIndex=100;s.display='none';s.position='absolute';if(!M._w)M.dP=M.cV;s=M.ah.style;s.font='8pt sans-serif';s.backgroundColor='#f3e5de';s.border='solid 1px #7B9EBD';s.height='18px';s.margin='2px';s.left='24px';s.top='0px';s.position='absolute';M.eC();var eo=M.G('DIV');M.ab.innerHTML="<a href='http://help.keymanweb.com/' target='_blank'><img src='"+KeymanWeb_Root+"kmicon.png' border='0' style='padding: 2px' title='KeymanWeb' alt='KeymanWeb' /></a>";s=M.ab.style;s.backgroundColor='white';s.border='solid 1px black';s.position='absolute';s.height='24px';s.font='bold 8pt sans-serif';s.display='none';s.textAlign='left';s.overflow='hidden';if(!M._w)M.dQ=M.cV;M.X(M.ab,'mousedown',M.fj);M.X(M.aM,'mousedown',M.fj);M.X(M.ab,'mouseover',M.fD);M.X(M.ab,'mouseout',M.fC);M.X(M.ah,'change',M.fA);var el=M.G('A'),s=M.cg.style;el.href='javascript:KeymanWeb.Help()';M.cg.src=KeymanWeb_Root+'kbdicon.gif';M.cg.title='Display visual keyboard';M.cg.border='0';s.width='24px';s.height='13px';s.top='2px';s.verticalAlign='bottom';s.padding='3px 2px 2px 2px';s.position='absolute';eo.appendChild(M.ah);el.appendChild(M.cg);eo.appendChild(el);M.ab.appendChild(eo);with(document.body){appendChild(M.ab);appendChild(M.aM);}if(document.selection&& !M.ef)M.X(document,'selectionchange',M.fB);if(window.removeEventListener)window.removeEventListener('focus',M.fb,true);M.fe=1;};M.GetAbsoluteX=function(dL){var eK=dL.offsetLeft,bc=dL;if(bc.offsetParent){while(bc.offsetParent){bc=bc.offsetParent;eK+=bc.offsetLeft;}}return eK;};M.GetAbsoluteY=function(dL){var eL=dL.offsetTop,bc=dL;if(bc.offsetParent){while(bc.offsetParent){bc=bc.offsetParent;eL+=bc.offsetTop;}}return eL;};M.fh=function(g){var A;if(g._KeymanWebSelectionStart)return g._KeymanWebSelectionStart;else if(g.setSelectionRange)return g.selectionStart;else if((A=g.ownerDocument)&&(A=A.defaultView)&&A.getSelection&&g.ownerDocument.designMode.toLowerCase()=='on'){var B=A.getSelection();if(B.focusNode.nodeType==3)return B.focusOffset;}return 0;};M.fk=function(dm){var M=KeymanWeb;if(M.f==null)dm.dir='';else if(M.f.KRTL)dm.dir='rtl';else dm.dir='ltr';};M.KR=function(dC){var M=KeymanWeb;var cu;M.bt=M.bu(M.bt,dC);for(cu in M.bO)if(dC.KI==M.bO[cu].KI){if(M.eg==dC.KI){M.f=dC;M.eC();if(M.aq!=null){M.dy=1;M.fk(M.aq);}}M.eg=null;return 1;}M.eg=null;var ap=M.G('OPTION');ap.value=dC.KI;ap.innerHTML=dC.KN;M.ah.appendChild(ap);ap=null;};M.KRS=function(dZ){var M=KeymanWeb;var eP;for(eP in M.bt)if(M.bt[eP].KI==dZ.KI)return 1;M.bO=M.bu(M.bO,dZ);var ap=M.G('OPTION');ap.value=dZ.KI;ap.innerHTML=dZ.KN;M.ah.appendChild(ap);ap=null;};M.KC=function(n,ln,g){var M=KeymanWeb,A;if(M.ef){return g.value.substr(g.length-n,ln);}else if((A=g.ownerDocument)&&(A=A.defaultView)&&A.getSelection&&g.ownerDocument.designMode.toLowerCase()=='on'){var B=A.getSelection();if(B.focusNode.nodeType==3)return B.focusNode.substringData(n<B.focusOffset?B.focusOffset-n:0,n<B.focusOffset?ln:B.focusOffset);else return "";}else if(g.setSelectionRange){var D,cn;if(g._KeymanWebSelectionStart){D=g._KeymanWebSelectionStart;cn=g._KeymanWebSelectionEnd;}else{D=g.selectionStart;cn=g.selectionEnd;}if(D<n){return g.value.substring(0,D);}return g.value.substring(D-n,D-n+ln);}else if((A=g.ownerDocument)&&(A=A.selection)){var aa=A.createRange();aa.moveStart('character',-n);return aa.text.substring(0,ln);}return "";};M.KCM=function(n,dm,val,ln){return this.KC(n,ln,dm)==val;};M.KIK=function(e){if(e.charCode!=null)return e.charCode!=0;return e.type=='keypress';};M.KKM=function(e,er,eQ){if(e.dH){if((er&0x4000)==0x4000){return(eQ==e.aI&&(er&0x7F)==e.Lmodifiers)}}else if((er&0x4000)==0){return e.aI==eQ;}return 0;};M.KKI=function(e){return{vk:e.dH,code:e.aI,modifiers:e.Lmodifiers};};M.KDM=function(n,dm,d){var M=KeymanWeb;if(!document.selection)n=M.fh(dm)-n;for(var i=0;i<M.w.length;i++)if(M.w[i].p==n&&M.w[i].d==d){return 1;}return false;};M.dE=new Array();M.R=0;M.KBR=function(){var M=KeymanWeb,ej;M.R=0;for(ej in M.dE){M.dE[ej].e.style.backgroundColor=M.dE[ej].c;}M.dE=new Array();};M.KB=function(g){var M=KeymanWeb;M.dE=M.bu(M.dE,{e:g,c:g.style.backgroundColor});g.style.backgroundColor='#000000';if(M.R==0){M.R=1;window.setTimeout('KeymanWeb.KBR()',50);}};M.KA=function(n,ch,s){if(ch=='')return 0;var eO=s.indexOf(ch);KeymanWeb.ew[n]=eO;return eO>=0;};M.KO=function(dn,g,s){var M=KeymanWeb;var j,A;if(M.ef){if(dn>0)g.value=g.value.substr(0,g.value.length-dn)+s;else g.value=g.value+s;}else if((A=g.ownerDocument)&&(A=A.defaultView)&&A.getSelection&&g.ownerDocument.designMode.toLowerCase()=='on'){var B=A.getSelection(),D=B.focusOffset;var aa=B.getRangeAt(0);if(dn>0)aa.setStart(B.focusNode,B.focusOffset-dn);aa.deleteContents();if(B.focusNode.nodeType==3){B.focusNode.insertData(B.focusOffset,s);B.extend(B.focusNode,B.focusOffset+s.length);B.collapseToEnd();}else{var n=g.ownerDocument.createTextNode(s);aa.insertNode(n);B.extend(n,s.length);B.collapseToEnd();}for(j=0;j<M.w.length;){if(M.w[j].p>D-dn&&M.w[j].p<=D){if(j>0)aK=M.w.slice(0,j-1);else aK=new Array();if(j<M.w.length-1)aK.concat(M.w.slice(j+1));M.w=aK;}else if(M.w[j].p>D)M.w[j].p+= -dn+s.length;j++;}}else if(g.setSelectionRange){var D,cn;if(g._KeymanWebSelectionStart){D=g._KeymanWebSelectionStart;cn=g._KeymanWebSelectionEnd;}else{D=g.selectionStart;cn=g.selectionEnd;}var et,eR;if(g.type.toLowerCase()=='textarea'&&typeof(g.scrollTop)!='undefined'){et=g.scrollTop;eR=g.scrollLeft;}if(dn<0){g.value=g.value.substring(0,D)+s+g.value.substring(cn);dn=0;}else if(D<dn)g.value=s+g.value.substring(cn);else g.value=g.value.substring(0,D-dn)+s+g.value.substring(cn);for(j=0;j<M.w.length;){if(M.w[j].p>D-dn&&M.w[j].p<=D){if(j>0)aK=M.w.slice(0,j-1);else aK=new Array();if(j<M.w.length-1)aK.concat(M.w.slice(j+1));M.w=aK;}else if(M.w[j].p>D)M.w[j].p+= -dn+s.length;j++;}if(typeof(et)!='undefined'){g.scrollTop=et;g.scrollLeft=eR;}g.setSelectionRange(D-dn+s.length,D-dn+s.length);g._KeymanWebSelectionStart=null;g._KeymanWebSelectionEnd=null;}else if((A=g.ownerDocument)&&(A=A.selection)){var aa=A.createRange(),aK,j;if(aa.text!='')A.clear();aa.collapse(true);if(dn>0)aa.moveStart('character',-dn);else dn=0;aa.text=s;for(j=0;j<M.w.length;){if(M.w[j].p<dn){if(j>0)aK=M.w.slice(0,j-1);else aK=new Array();if(j<M.w.length-1)aK.concat(M.w.slice(j+1));M.w=aK;}else M.w[j].p+= -dn+s.length;j++;}M.dG=A.createRange();M.dG.scrollIntoView();}};M.KDO=function(dY,g,fv){var J=new Object(),M=KeymanWeb;if(dY>0)M.KO(dY,g,"");J.p=M.fh(g);J.d=fv;M.w=M.bu(M.w,J);};M.KIO=function(dY,eY,eX,g){var M=KeymanWeb;if(M.ew[eX-1]<eY.length)M.KO(dY,g,eY.charAt(M.ew[eX-1]));};M.aM.onmouseover=M.fG;M.aM.onmouseout=M.fF;M.X(window,'load',M.eI);M.X(window,'unload',M.fR);if(window.addEventListener)window.addEventListener('focus',M.fb,true);document.writeln("<style type='text/css'>"+".KeymanWeb_VK_0{font: bold 0.6em sans-serif;color:#c0c0c0}"+".KeymanWeb_VK_1{color:blue}"+".KeymanWeb_VK_2{background-color:white;border:1px solid black}"+".KeymanWeb_VK_3{background:white;border:solid 1px #808080}"+".KeymanWeb_VK_4{background:white;border:solid 1px #808080}"+".KeymanWeb_VK_5{background:#c0c0c0;border:solid 1px #808080;font:bold 0.5em sans-serif;color:#808080}"+".KeymanWeb_VK_6{background:#e0e0e0}"+".KeymanWeb_VK_7{background:#c0c0ff}"+".KeymanWeb_VK_8{background-color:#e0e0ff}"+"</style>");} 
